<div ng-controller="record:view" class="row">
  <div class="col-md-12">

    <h1>{{ recordType }} #{{ guid }}</h1>
    <p>Delete this {{ recordType }}: <span ng-click="deleteRecord()" class="glyphicon glyphicon-remove">&nbsp;</span></p>

    <ul>
      <!-- special data we can render -->
      <li ng-repeat="(key, value) in record" ng-if="key == 'personGuid'"><a href="/#/person/{{ value }}"><strong>{{ key }}: </strong>{{ value }}</a></li>
      <li ng-repeat="(key, value) in record" ng-if="key == 'eventGuid'"><a href="/#/event/{{ value }}"><strong>{{ key }}: </strong>{{ value }}</a></li>
      <li ng-repeat="(key, value) in record" ng-if="key == 'messageGuid'"><a href="/#/message/{{ value }}"><strong>{{ key }}: </strong>{{ value }}</a></li>
      <li ng-repeat="(key, value) in record" ng-if="key == 'campaignId'"><a href="/#/campaign/{{ value }}/stats"><strong>{{ key }}: </strong>{{ value }}</a></li>

      <!-- normal data -->
      <li ng-repeat="(key, value) in record" ng-if="renderableData.indexOf(key) < 0"><strong>{{ key }}: </strong>{{ value }}</li>
    </ul>

    <table class="table table-striped table-hover">

      <thead>
        <tr>
          <th>Key</th>
          <th>Value</th>
        </tr>
      </thead>

      <tbody ng-repeat="(key, value) in record.data">
        <tr>
          <td><span ng-click="deleteAttribute(key)" class="glyphicon glyphicon-remove">&nbsp;</span> {{ key }}</td>
          <td>
            <form ng-submit="updateAttribute(key)">
              <span class="glyphicon glyphicon-edit">&nbsp;</span><input ng-model="record.data[key]" type="text" style="width:90%" >
            </form>
          </td>
        </tr>
      </tbody>

    </table>

    <div class="row">
      <form class="form-horizontal" ng-submit="addAttribute()">
        <div class="col-md-12">
          <h3>Add a key:</h3>
        </div>

        <div class="col-md-5">
          <label class="control-label">Key</label>
          <input type="text" class="form-control" id="newKey" placeholder="firstName" ng-model="newAttribute.key">
        </div>

        <div class="col-md-5">
          <label class="control-label">Value</label>
          <input type="text" class="form-control" id="newKey" placeholder="firstName" ng-model="newAttribute.value">
        </div>

        <div class="col-md-1">
          <label class="control-label">&nbsp;</label>
          <button type="submit" class="form-control btn btn-primary">Add</button>
        </div>

      </form>
    </div>

    <!-- special data we can render -->
    <div class="row">
      <div ng-if="record.body">
        <hr />
        <iframe id="bodyIframe" scrolling="no" frameborder="0" onLoad="MESSAGEBOT.utils.iframeResizeToFit('bodyIframe')"></iframe>
      </div>

      <div ng-if="map">
        <hr />
        <leaflet id="locationMap" height="300px" width="100%" markers="map.markers" center="map.center"></leaflet>
      </div>
    </div>

    <div class="row" ng-if="lists">
      <h2>Lists</h2>

      <table class="table table-striped table-hover">

        <thead>
          <tr>
            <th>&nbsp;</th>
            <th>joined at</th>
            <th>name</th>
            <th>type</th>
          </tr>
        </thead>

        <tbody ng-repeat="list in lists">
          <tr>
            <td><a href="/#/list/{{ list.id }}/people"><span class="glyphicon glyphicon-pencil">&nbsp;</span></a></td>
            <td>{{ list.joinedAt }}</td>
            <td>{{ list.name }}</td>
            <td>{{ list.type }}</td>
          </tr>
        </tbody>

      </table>
    </div>

  </div>
</div>
